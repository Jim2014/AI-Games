<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Two-Player Bounce Ball Game</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #1a202c; /* Dark background */
            font-family: 'Inter', sans-serif;
            color: #e2e8f0; /* Light text color */
            flex-direction: column;
            padding: 20px;
            box-sizing: border-box;
        }

        .game-container {
            background-color: #2d3748; /* Slightly lighter dark for container */
            border-radius: 12px;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.2);
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            max-width: 95vw; /* Responsive width */
            width: 1200px; /* Max width for desktop to accommodate two panes */
            gap: 20px;
        }

        h1 {
            color: #90cdf4; /* Light blue heading */
            margin-bottom: 20px;
            font-size: 2.5em;
            text-align: center;
        }

        /* Main layout for game and info panes */
        .main-game-layout {
            display: flex;
            flex-direction: row; /* Default: side-by-side */
            gap: 20px;
            width: 100%;
            justify-content: center;
            align-items: flex-start; /* Align items to the top */
        }

        .game-area {
            flex: 2; /* Game area takes more space */
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #000; /* Black background for game area */
            border: 2px solid #a0aec0; /* Grey border for canvas */
            border-radius: 8px;
            overflow: hidden; /* Ensure canvas doesn't overflow */
            position: relative; /* For canvas positioning */
        }

        canvas {
            display: block;
            touch-action: none; /* Disable default touch actions like scrolling/zooming */
            max-width: 100%; /* Ensure canvas scales down */
            height: auto; /* Maintain aspect ratio */
            border-radius: 6px; /* Slightly smaller border radius for canvas itself */
        }

        .info-area {
            flex: 1; /* Info area takes less space */
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding: 15px;
            background-color: #2d3748; /* Same as game-container */
            border-radius: 12px;
            box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.1);
        }

        .score-board {
            display: flex;
            flex-direction: column; /* Stack scores vertically in info pane */
            gap: 10px;
            width: 100%;
            font-size: 1.8em;
            font-weight: 700;
            background-color: #4a5568; /* Darker grey for score background */
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .score-board span {
            padding: 5px 10px;
            color: #edf2f7; /* White text for scores */
        }

        .game-info-panel {
            background-color: #4a5568;
            border-radius: 8px;
            padding: 15px;
            font-size: 1.1em;
            text-align: center;
            line-height: 1.6;
            color: #cbd5e0;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .controls-info {
            background-color: #4a5568;
            border-radius: 8px;
            padding: 15px;
            font-size: 1.1em;
            text-align: center;
            line-height: 1.6;
            color: #cbd5e0;
        }

        .controls-info strong {
            color: #63b3ed; /* Brighter blue for key names */
        }

        /* Responsive adjustments */
        @media (max-width: 900px) {
            .main-game-layout {
                flex-direction: column; /* Stack panes vertically on smaller screens */
                align-items: center; /* Center items when stacked */
            }
            .game-area, .info-area {
                width: 100%; /* Full width when stacked */
                max-width: 600px; /* Limit width for aesthetics on medium screens */
            }
            .info-area {
                margin-top: 20px; /* Add some space between stacked panes */
            }
            .score-board {
                flex-direction: row; /* Arrange scores side-by-side again */
                justify-content: space-around;
                font-size: 1.5em;
            }
            .game-info-panel {
                flex-direction: row;
                justify-content: space-around;
            }
        }

        @media (max-width: 600px) {
            h1 {
                font-size: 2em;
            }
            .score-board {
                font-size: 1.2em;
            }
            .game-info-panel, .controls-info {
                font-size: 0.9em;
                padding: 10px;
            }
            .game-container {
                padding: 15px;
            }
            .score-board span {
                padding: 5px 8px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>Bounce Ball Showdown!</h1>
        <div class="main-game-layout">
            <div class="game-area">
                <canvas id="gameCanvas"></canvas>
            </div>
            <div class="info-area">
                <div class="score-board">
                    <span>Player 1: <span id="player1Score">0</span></span>
                    <span>Player 2: <span id="player2Score">0</span></span>
                </div>
                <div class="game-info-panel">
                    <span>Time: <span id="gameTimeDisplay">0.0</span>s</span>
                    <span>Speed: <span id="ballSpeedDisplay">0.0</span></span>
                </div>
                <div class="controls-info">
                    <p><strong>Player 1 Controls:</strong> <br> Move Up: <strong>W</strong> &nbsp; Move Down: <strong>S</strong></p>
                    <p><strong>Player 2 Controls:</strong> <br> Move Up: <strong>&#8593; (Arrow Up)</strong> &nbsp; Move Down: <strong>&#8595; (Arrow Down)</strong></p>
                    <p><strong>Touch Controls:</strong> <br> Player 1: Tap left half of screen &nbsp; Player 2: Tap right half of screen</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Get the canvas element and its 2D rendering context
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Get score and game info display elements
        const player1ScoreDisplay = document.getElementById('player1Score');
        const player2ScoreDisplay = document.getElementById('player2Score');
        const gameTimeDisplay = document.getElementById('gameTimeDisplay');
        const ballSpeedDisplay = document.getElementById('ballSpeedDisplay');

        // Game dimensions and elements
        const GAME_WIDTH = 800;
        const GAME_HEIGHT = 500;
        const PADDLE_WIDTH = 15;
        const PADDLE_HEIGHT = 100;
        const BALL_RADIUS = 10;
        const INITIAL_BALL_SPEED = 5; // Initial speed of the ball

        // Game state variables
        let gameStarted = false;
        let gameTime = 0; // in seconds
        let lastFrameTime = performance.now(); // For tracking time and speed
        const BALL_SPEED_INCREASE_RATE = 0.005; // Rate at which ball speed increases per second
        let currentBallSpeed = INITIAL_BALL_SPEED; // This will be dynamically updated

        // Player 1 paddle object
        let player1 = {
            x: 0,
            y: (GAME_HEIGHT - PADDLE_HEIGHT) / 2, // Center vertically
            width: PADDLE_WIDTH,
            height: PADDLE_HEIGHT,
            dy: 0, // Vertical movement speed
            score: 0
        };

        // Player 2 paddle object
        let player2 = {
            x: GAME_WIDTH - PADDLE_WIDTH, // Right edge
            y: (GAME_HEIGHT - PADDLE_HEIGHT) / 2,
            width: PADDLE_WIDTH,
            height: PADDLE_HEIGHT,
            dy: 0,
            score: 0
        };

        // Ball object
        let ball = {
            x: GAME_WIDTH / 2,
            y: GAME_HEIGHT / 2,
            radius: BALL_RADIUS,
            dx: 0, // Initial horizontal speed (starts at 0, set on Enter)
            dy: 0 // Initial vertical speed (starts at 0, set on Enter)
        };

        // Object to track pressed keys
        let keysPressed = {};

        /**
         * Resets the ball's position and direction after a point is scored or game restarts.
         * The ball always starts from the center with no initial movement.
         */
        function resetBall() {
            ball.x = GAME_WIDTH / 2;
            ball.y = GAME_HEIGHT / 2;
            ball.dx = 0; // Stop ball
            ball.dy = 0; // Stop ball
            gameStarted = false; // Game is paused until 'Enter' is pressed
            gameTime = 0; // Reset game time
            currentBallSpeed = INITIAL_BALL_SPEED; // Reset ball speed
        }

        /**
         * Draws the game elements (paddles, ball, scores, info) on the canvas.
         */
        function draw() {
            // Clear the entire canvas
            ctx.clearRect(0, 0, GAME_WIDTH, GAME_HEIGHT);

            // Draw player 1 paddle
            ctx.fillStyle = '#63b3ed'; /* Blue */
            ctx.fillRect(player1.x, player1.y, player1.width, player1.height);

            // Draw player 2 paddle
            ctx.fillStyle = '#fc8181'; /* Red */
            ctx.fillRect(player2.x, player2.y, player2.width, player2.height);

            // Draw the ball
            ctx.fillStyle = '#f6e05e'; /* Yellow */
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
            ctx.fill();

            // Update score displays
            player1ScoreDisplay.textContent = player1.score;
            player2ScoreDisplay.textContent = player2.score;

            // Update time and speed displays
            gameTimeDisplay.textContent = gameTime.toFixed(1);
            ballSpeedDisplay.textContent = currentBallSpeed.toFixed(1);

            // Draw "Press Enter to Start" message if game is not started
            if (!gameStarted) {
                ctx.fillStyle = '#a0aec0'; /* Light grey */
                ctx.font = '40px "Inter"';
                ctx.textAlign = 'center';
                ctx.fillText('Press Enter to Start', GAME_WIDTH / 2, GAME_HEIGHT / 2);
            }
        }

        /**
         * Updates the game state, including ball movement, paddle movement, and collision detection.
         */
        function update() {
            // Only update game elements if the game has started
            if (!gameStarted) {
                return;
            }

            // Calculate delta time for consistent updates across different frame rates
            const currentTime = performance.now();
            const deltaTime = (currentTime - lastFrameTime) / 1000; // time in seconds
            lastFrameTime = currentTime;

            // Update game time
            gameTime += deltaTime;

            // Increase ball speed over time
            currentBallSpeed = INITIAL_BALL_SPEED * (1 + gameTime * BALL_SPEED_INCREASE_RATE);

            // Move paddles based on their dy (movement speed)
            player1.y += player1.dy;
            player2.y += player2.dy;

            // Keep paddles within canvas bounds
            player1.y = Math.max(0, Math.min(player1.y, GAME_HEIGHT - player1.height));
            player2.y = Math.max(0, Math.min(player2.y, GAME_HEIGHT - player2.height));

            // Move the ball, applying the current speed while preserving direction
            ball.x += Math.sign(ball.dx) * currentBallSpeed;
            ball.y += Math.sign(ball.dy) * currentBallSpeed;

            // Ball collision with top and bottom walls
            if (ball.y + ball.radius > GAME_HEIGHT || ball.y - ball.radius < 0) {
                ball.dy *= -1; // Reverse vertical direction
            }

            // Ball collision with paddles
            // Player 1 paddle collision (left paddle)
            if (ball.dx < 0 && // Ball is moving left
                ball.x - ball.radius < player1.x + player1.width && // Ball's left edge is past paddle's right edge
                ball.y + ball.radius > player1.y && // Ball's bottom edge is below paddle's top edge
                ball.y - ball.radius < player1.y + player1.height) { // Ball's top edge is above paddle's bottom edge
                ball.dx *= -1; // Reverse horizontal direction
                // Adjust ball position to prevent sticking inside the paddle
                ball.x = player1.x + player1.width + ball.radius;
            }

            // Player 2 paddle collision (right paddle)
            if (ball.dx > 0 && // Ball is moving right
                ball.x + ball.radius > player2.x && // Ball's right edge is past paddle's left edge
                ball.y + ball.radius > player2.y && // Ball's bottom edge is below paddle's top edge
                ball.y - ball.radius < player2.y + player2.height) { // Ball's top edge is above paddle's bottom edge
                ball.dx *= -1; // Reverse horizontal direction
                // Adjust ball position to prevent sticking inside the paddle
                ball.x = player2.x - ball.radius;
            }

            // Scoring
            // Ball goes past player 1 (left side) - Player 2 scores
            if (ball.x - ball.radius < 0) {
                player2.score++;
                resetBall(); // Reset ball position and game state
            }
            // Ball goes past player 2 (right side) - Player 1 scores
            if (ball.x + ball.radius > GAME_WIDTH) {
                player1.score++;
                resetBall(); // Reset ball position and game state
            }
        }

        /**
         * The main game loop. Calls update and draw functions repeatedly.
         */
        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop); // Request next frame for smooth animation
        }

        /**
         * Handles key presses for paddle movement and game start.
         * @param {KeyboardEvent} event - The keyboard event object.
         */
        document.addEventListener('keydown', (event) => {
            keysPressed[event.key] = true; // Mark key as pressed

            // Start game on Enter key press if not already started
            if (event.key === 'Enter' && !gameStarted) {
                gameStarted = true;
                // Give ball random initial direction
                ball.dx = (Math.random() < 0.5 ? 1 : -1) * INITIAL_BALL_SPEED; // Random horizontal direction
                ball.dy = (Math.random() < 0.5 ? 1 : -1) * INITIAL_BALL_SPEED; // Random vertical direction
                lastFrameTime = performance.now(); // Start timing for speed calculation
            }

            // Prevent default browser behavior for specific keys to stop page scrolling
            if (event.key === 'ArrowUp' || event.key === 'ArrowDown' || event.key === 'w' || event.key === 's') {
                event.preventDefault();
            }
            updatePaddleMovement();
        });

        /**
         * Handles key releases, stopping paddle movement.
         * @param {KeyboardEvent} event - The keyboard event object.
         */
        document.addEventListener('keyup', (event) => {
            delete keysPressed[event.key]; // Mark key as released
            updatePaddleMovement();
        });

        /**
         * Updates paddle's dy (vertical movement speed) based on currently pressed keys.
         */
        function updatePaddleMovement() {
            // Player 1 controls (W, S)
            if (keysPressed['w'] || keysPressed['W']) {
                player1.dy = -7;
            } else if (keysPressed['s'] || keysPressed['S']) {
                player1.dy = 7;
            } else {
                player1.dy = 0;
            }

            // Player 2 controls (ArrowUp, ArrowDown)
            if (keysPressed['ArrowUp']) {
                player2.dy = -7;
            } else if (keysPressed['ArrowDown']) {
                player2.dy = 7;
            } else {
                player2.dy = 0;
            }
        }

        /**
         * Handles touch input for paddle movement.
         * Tapping on the left half controls player 1, right half controls player 2.
         * A tap moves the paddle towards the tap location.
         * @param {TouchEvent} event - The touch event object.
         */
        canvas.addEventListener('touchstart', (event) => {
            event.preventDefault(); // Prevent default browser touch behavior (like scrolling)

            if (!gameStarted) { // If game not started, a touch can act like 'Enter'
                 gameStarted = true;
                 ball.dx = (Math.random() < 0.5 ? 1 : -1) * INITIAL_BALL_SPEED;
                 ball.dy = (Math.random() < 0.5 ? 1 : -1) * INITIAL_BALL_SPEED;
                 lastFrameTime = performance.now();
            }

            for (let i = 0; i < event.touches.length; i++) {
                const touch = event.touches[i];
                const rect = canvas.getBoundingClientRect();
                const touchX = touch.clientX - rect.left;
                const touchY = touch.clientY - rect.top;

                // Determine if touch is for Player 1 or Player 2 based on horizontal position
                if (touchX < GAME_WIDTH / 2) { // Left half for Player 1
                    if (touchY < player1.y + PADDLE_HEIGHT / 2) {
                        player1.dy = -7; // Move up
                    } else {
                        player1.dy = 7; // Move down
                    }
                } else { // Right half for Player 2
                    if (touchY < player2.y + PADDLE_HEIGHT / 2) {
                        player2.dy = -7; // Move up
                    } else {
                        player2.dy = 7; // Move down
                    }
                }
            }
        });

        /**
         * Stops paddle movement on touch end.
         * @param {TouchEvent} event - The touch event object.
         */
        canvas.addEventListener('touchend', (event) => {
            event.preventDefault();
            // Stop movement for paddles if no touches remain
            if (event.touches.length === 0) {
                player1.dy = 0;
                player2.dy = 0;
            }
        });

        /**
         * Sets the canvas dimensions. The game logic uses fixed GAME_WIDTH and GAME_HEIGHT,
         * but the canvas display size adjusts responsively to fit its container while
         * maintaining the aspect ratio.
         */
        function setCanvasDimensions() {
            canvas.width = GAME_WIDTH;
            canvas.height = GAME_HEIGHT;
            // The game-area now has a flexible width, so let the canvas fill it.
            canvas.style.width = '100%';
            canvas.style.height = `${GAME_HEIGHT * (canvas.offsetWidth / GAME_WIDTH)}px`; /* Maintain aspect ratio */

            // Adjust the height to ensure it fits within the viewport, if needed, maintaining aspect ratio.
            const gameArea = document.querySelector('.game-area');
            const gameAreaRect = gameArea.getBoundingClientRect();
            // Check if current height exceeds available viewport height minus some padding
            if (gameAreaRect.height > window.innerHeight - 80) {
                canvas.style.height = (window.innerHeight - 80) + 'px';
                canvas.style.width = (GAME_WIDTH * (canvas.offsetHeight / GAME_HEIGHT)) + 'px';
            }
        }

        // Call functions to initialize and start the game
        window.onload = function() {
            setCanvasDimensions();
            resetBall(); // Ensure ball is in center, game is paused
            gameLoop(); // Start the animation loop to draw the initial state and message
        };

        // Adjust canvas dimensions on window resize
        window.addEventListener('resize', setCanvasDimensions);

    </script>
</body>
</html>
